version: 2

sources:
  - name: dbut
    database: sf_dbt
    schema: utilpack
    tables:
      - name: emp_yash
      - name: emp_yash_dep

models:
  # - name: emp_yash_dep
  #   columns:
  #     - name: deptid
  #       tests:
  #         - relationships:
  #             to: ref('emp_yash')
  #             field: deptid

  # - name : emp_yash
  #   tests:
  #     - dbt_utils.equality:
  #         compare_model: ref('emp_yash_dep')
  #         compare_columns:
  #           - deptid

  # - name: emp_yash
  #   tests:
  #     - dbt_utils.expression_is_true:
  #         expression: " location is not null"

  # - name : emp_yash
  #   tests:
  #     - dbt_utils.recency:
  #         datepart: year
  #         field: ldts
  #         interval: -2
  #         # ignore_time_component : True

# most_recent value > treshold then it is good
  - name: emp_yash
    columns:
      - name: ldts
        tests:
          - dbt_utils.not_constant
