version: 2

sources:
  - name: dbut
    database: sf_dbt
    schema: utilpack
    tables:
      - name: emp_yash
      - name: emp_yash_dep

models:
  # - name: emp_yash_dep
  #   columns:
  #     - name: deptid
  #       tests:
  #         - relationships:
  #             to: ref('emp_yash')
  #             field: deptid

  # - name : emp_yash
  #   tests:
  #     - dbt_utils.equality:
  #         compare_model: ref('emp_yash_dep')
  #         compare_columns:
  #           - deptid

  # - name: emp_yash
  #   tests:
  #     - dbt_utils.expression_is_true:
  #         expression: " location is not null"

  # - name : emp_yash
  #   tests:
  #     - dbt_utils.recency:
  #         datepart: year
  #         field: ldts
  #         interval: -2
  #         # ignore_time_component : True

# most_recent value > treshold then it is good
  # - name: emp_yash
  #   columns:
  #     - name: deptid
  #       tests:
  #         - dbt_utils.cardinality_equality:
  #             field: deptid
  #             to: ref('emp_yash_dep')

  # - name: emp_yash
  #   columns:
  #     - name: location
  #       tests:
  #         - dbt_utils.not_null_proportion:
  #             at_least: 0.95

  # - name: emp_yash
  #   columns:
  #     - name: empid
  #       tests:
  #         - dbt_utils.sequential_values:
  #             interval: 10
  #             # datepart: 'hour'

  - name: emp_yash
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - name
            - location


